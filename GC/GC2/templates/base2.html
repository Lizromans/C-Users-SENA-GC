{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block titulo %}{% endblock %}</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <!-- CSS personalizado -->
    <link href="{% static 'css/base2.css' %}" rel="stylesheet">

  {% block css %}{% endblock %}
</head>
<body>
    <div>
        <!-- Header fijo -->
        <div class="header-container">
            <header class="header-content">
                <div class="header-left">
                    <span class="sidebar-icon">
                        <i class="fa fa-dashboard" aria-hidden="true"></i>
                        Dashboard
                        {% if current_page_name %}
                            / {{ current_page_name }}
                        {% endif %}
                        {% if semillero %}
                            / {{ semillero.sigla }}
                        {% endif %}  
                    </span>
                </div>
                <div class="header-right">
                    <div class="user-info">
                        <span class="user-icon">
                            {% if usuario.imagen_perfil %}
                                <img src="{{ usuario.imagen_perfil.url }}" alt="Foto de perfil" class="foto-perfil">
                            {% else %}
                                <div class="foto-placeholder">
                                    <img src="{% static 'img/cam.png' %}" alt="foto de perfil">
                                </div>
                            {% endif %}
                        </span>
                        <span class="user">
                            <a>{{ request.session.nom_usu }}</a>
                            <p>{{ request.session.rol }}</p>
                        </span>
                    </div>
                </div>
            </header>
        </div>

        <!-- Sidebar -->
        <div class="sidebar-container">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <!-- Bot√≥n √∫nico que abre y cierra -->
                    <button class="btn-open" aria-label="Abrir/Cerrar men√∫">‚ò∞</button>
                    <h5 class="sidebar-title">Men√∫ de Navegaci√≥n</h5>
                </div>

                <div class="sidebar-body">
                    <nav>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link {% if current_page == 'home' %}active{% endif %}" 
                                   href="{% url 'home' %}">
                                    <span class="nav-icon">üè†</span>
                                    <span class="nav-text">Inicio</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if current_page == 'perfil' %}active{% endif %}" 
                                   href="{% url 'perfil' %}">
                                    <span class="nav-icon">üë§</span>
                                    <span class="nav-text">Mi Perfil</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if current_page == 'semilleros' or current_page == 'resumen' or current_page == 'resu_miembros' or current_page == 'resu_proyectos' %}active{% endif %}" 
                                    href="{% url 'semilleros' %}">
                                    <span class="nav-icon">üå±</span>
                                    <span class="nav-text">Semilleros</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if current_page == 'proyectos' %}active{% endif %}" 
                                    href="{% url 'proyectos' %}">
                                    <span class="nav-icon">üìä</span>
                                    <span class="nav-text">Proyectos</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if current_page == 'miembros' %}active{% endif %}" 
                                   href="{% url 'miembros' %}">
                                    <span class="nav-icon">üë•</span>
                                    <span class="nav-text">Miembros</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if current_page == 'centroayuda' %}active{% endif %}" 
                                   href="{% url 'centroayuda' %}">
                                    <span class="nav-icon">‚ùì</span>
                                    <span class="nav-text">Centro de Ayuda</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link {% if current_page == 'reportes' %}active{% endif %}" 
                                   href="{% url 'reportes' %}">
                                    <span class="nav-icon">üìã</span>
                                    <span class="nav-text">Reportes</span>
                                </a>
                            </li>
                        </ul>
                        <ul class="nav-footer">
                            <li>
                                <button class="config-btn" data-bs-toggle="modal" data-bs-target="#cambiarContrase√±aModal">
                                    <span class="nav-icon">
                                        <img src="{% static 'img/privacidad.png' %}" alt="Icono de Privacidad">
                                    </span>
                                    <span class="nav-text">Privacidad</span>
                                </button>
                            </li>
                            <li>
                                <form action="{% url 'logout' %}" method="post">
                                    {% csrf_token %}
                                    <button class="logout-btn" type="submit">
                                        <span class="nav-icon">
                                            <img src="{% static 'img/logout.png' %}" alt="Icono de Cerrar Sesi√≥n">
                                        </span>
                                        <span class="nav-text">Cerrar Sesi√≥n</span>
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </nav>
                </div>
            </aside>
        </div>
    </div>

    <!-- Modal con el formulario -->
    <div class="modal fade" id="cambiarContrase√±aModal" tabindex="-1" aria-labelledby="cambiarContrase√±aLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                
                <!-- Encabezado -->
                <div class="modal-header">
                    <h5 class="modal-title" id="cambiarContrase√±aLabel">Cambiar Contrase√±a</h5>
                </div>

                <!-- Cuerpo del modal -->
                <div class="modal-body">
                    <form method="POST" action="{% url 'privacidad' %}" id="cambio-contrase√±a-form">
                        {% csrf_token %}
                        
                        <div class="form-section mb-3">
                            <label for="contrase√±a_actual">Contrase√±a Actual</label>
                            <div class="input-con-icono">
                                <input type="password" class="form-control" id="contrase√±a_actual" name="contrase√±a_actual" required>
                                <span class="edit-icon"><i class="fas fa-eye"></i></span>
                            </div>
                        </div>

                        <div class="form-section mb-3">
                            <label for="nueva_contrase√±a">Nueva Contrase√±a</label>
                            <div class="input-con-icono">
                                <input type="password" class="form-control" id="nueva_contrase√±a" name="nueva_contrase√±a" required>
                                <span class="edit-icon"><i class="fas fa-eye"></i></span>
                            </div>
                        </div>

                        <div class="form-section mb-3">
                            <label for="confirmar_contrase√±a">Confirmar Nueva Contrase√±a</label>
                            <div class="input-con-icono">
                                <input type="password" class="form-control" id="confirmar_contrase√±a" name="confirmar_contrase√±a" required>
                                <span class="edit-icon"><i class="fas fa-eye"></i></span>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Pie del modal -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" onclick="document.getElementById('cambio-contrase√±a-form').submit();">
                        Guardar cambios
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Contenido principal -->
    <div class="main-content">
        <main>
            
            <!-- Contenedor Principal con Gradiente y C√≠rculos -->
            <div class="contenedor-principal" data-semillero-id="{{ semillero.id_sem }}">
                <div class="bienvenida">
                    <div class="card-body">
                        <h4>{{ semillero.nombre }}</h4>
                        <h5>{{ semillero.sigla }}</h5>
                        <h6>{{ semillero.cod_sem }}</h6>
                        <p class="card-text">{{ semillero.desc_sem|default:"Sin descripci√≥n disponible" }}</p>
                        <div class="card-info">
                            <span class="badge bg-secondary">
                                <strong>{{ total_miembros|default:0 }}</strong>
                                <span>Miembros</span>
                            </span>
                            <span class="badge bg-secondary">
                                <strong>{{ total_proyectos|default:0 }}</strong>
                                <span>Proyectos</span>
                            </span>
                            <span class="badge bg-secondary">
                                <strong>{{ total_entregables|default:0 }}</strong>
                                <span>Entregables</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="menu">
                <a href="{% url 'resumen' semillero.id_sem %}" class="menu-button {% if current_page == 'resumen' %}active{% endif %}">
                    <img src="{% static 'img/Clipboard.png' %}" alt="Icono de Folder" class="icon-button">
                    Resumen</a>
                <a href="{% url 'resu-miembros' semillero.id_sem %}" class="menu-button {% if current_page == 'resu_miembros' %}active{% endif %}">
                    <img src="{% static 'img/people.png' %}" alt="Icono de Usuarios" class="icon-button">
                    Miembros</a>
                <a href="{% url 'resu-proyectos' semillero.id_sem %}" class="menu-button {% if current_page == 'resu_proyectos' %}active{% endif %}">
                    <img src="{% static 'img/project.png' %}" alt="Icono de Proyectos" class="icon-button">
                    Proyectos</a>
                <a href="{% url 'recursos' semillero.id_sem %}" class="menu-button {% if current_page == 'recursos' %}active{% endif %}">
                    <img src="{% static 'img/recursos.png' %}" alt="Icono de Recursos Digitales" class="icon-button">
                    Recursos</a>            
            </div>
            <div class="contenido">
                <script src="{% static 'js/mensaje.js' %}"></script>
                {% block main %}{% endblock %}
            </div>
        </main>
    </div>

    <!-- JS de Bootstrap y dependencias -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/sidebar.js' %}"></script>
    <script src="{% static 'js/contrase√±a.js' %}"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const contenedor = document.querySelector('.contenedor-principal');
        
        if (contenedor) {
            const semilleroId = parseInt(contenedor.getAttribute('data-semillero-id'));
            
            // Array de gradientes que coinciden exactamente con los colores de las cards
            const colores = [
                'linear-gradient(90deg, rgba(151, 71, 255, 1) 0%, rgba(151, 71, 255, 0.884) 75%)',  // 1. Morado
                'linear-gradient(90deg, rgba(255, 71, 151, 1) 0%, rgba(255, 71, 151, 0.884) 75%)',  // 2. Rosa
                'linear-gradient(90deg, rgba(71, 255, 151, 1) 0%, rgba(71, 255, 151, 0.884) 75%)',  // 3. Verde
                'linear-gradient(90deg, rgba(255, 151, 71, 1) 0%, rgba(255, 151, 71, 0.884) 75%)',  // 4. Naranja
                'linear-gradient(90deg, rgba(71, 151, 255, 1) 0%, rgba(71, 151, 255, 0.884) 75%)'   // 5. Azul
            ];
            
            // Usar el mismo c√°lculo que las cards: nth-child usa posici√≥n, no ID
            // Para hacer coincidir con las cards, usamos el ID del semillero
            const colorIndex = ((semilleroId - 1) % 5);
            
            // Aplica el color directamente al elemento
            contenedor.style.background = colores[colorIndex];
            
            console.log(`Semillero ID: ${semilleroId}, Color Index: ${colorIndex}, Gradiente aplicado: Color ${colorIndex + 1}`);
        }
    });
    </script>
  
</body>
</html>