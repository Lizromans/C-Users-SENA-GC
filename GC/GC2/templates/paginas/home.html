{% extends "base.html" %}
{% load static %}
{% block titulo %} Home {% endblock %}
{% block css %}
<link href="{% static 'css/home.css' %}" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}
{% block contenido %} {% endblock %}
{% block main %}
    <!-- Mensajes de alerta -->
    {% if messages %}
    <script>
        {% for message in messages %}
            mostrarMensajeExito("{{ message|escapejs }}", "{{ message.tags }}");
        {% endfor %}
    </script>
    {% endif %}

    <div class="contenedor-principal">
        <!-- Contenedor info con Gradiente y C√≠rculos -->
        <div class="contenedor-info">
            <div class="bienvenida">
                <div class="info">
                    <h3>¬°Bienvenido {{ usuario.nom_usu }}!</h3>
                    <p>Gestiona tus semilleros y proyectos de manera eficiente.</p>
                </div>
                <div class="card-container">
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-subtitle">{{ total_semilleros }}</h6>
                            <p class="card-text">Semilleros</p>
                        </div>    
                    </div>
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-subtitle">{{ total_proyectos }}</h6>
                            <p class="card-text">Proyectos</p>
                        </div>    
                    </div>
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-subtitle">{{ total_aprendices }}</h6>
                            <p class="card-text">Aprendices</p>
                        </div>    
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contenedor terciario -->
        <div class="contenedor-tres">
            <h2>Actividad Reciente</h2>
            <div class="timeline">
                {% if actividades %}
                    {% for actividad in actividades %}
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <div class="timeline-date">
                                {% if actividad.fecha_actividad %}
                                    {{ actividad.fecha_actividad|date:"d M Y" }}
                                    {% if actividad.tipo_actividad == 'evento' %}
                                        - {{ actividad.hora_inicio|time:"H:i" }}
                                    {% endif %}
                                {% endif %}
                            </div>
                            
                            {% if actividad.tipo_actividad == 'semillero' %}
                                <h3 class="timeline-title-item">
                                    <i class="fas fa-flask"></i> Semillero Creado
                                </h3>
                                <p class="timeline-description">
                                    Se cre√≥ el semillero <strong>{{ actividad.nombre }}</strong>
                                </p>
                                <span class="badge badge-semillero">{{ actividad.sigla }}</span>
                                
                            {% elif actividad.tipo_actividad == 'proyecto' %}
                                <h3 class="timeline-title-item">
                                    <i class="fas fa-project-diagram"></i> Proyecto Creado
                                </h3>
                                <p class="timeline-description">
                                    Se cre√≥ el proyecto <strong>{{ actividad.nom_pro }}</strong>
                                </p>
                                <span class="badge badge-proyecto">
                                    {% if actividad.tipo == "capacidadinstalada" %}
                                        Capacidad Instalada
                                    {% elif actividad.tipo == "formativo" %}
                                        Formativo
                                    {% elif actividad.tipo == "sennova" %}
                                        Sennova
                                    {% else %}
                                        {{ actividad.tipo|capfirst }}
                                    {% endif %}
                                </span>
                                <small class="text-muted d-block mt-1">
                                    Estado: {{ actividad.estado_pro }} | Progreso: {{ actividad.progreso }}%
                                </small>
                                
                            {% elif actividad.tipo_actividad == 'entregable' %}
                                <h3 class="timeline-title-item">
                                    <i class="fas fa-tasks"></i> Nuevo Entregable
                                </h3>
                                <p class="timeline-description">
                                    <strong>{{ actividad.nom_entre }}</strong> - {{ actividad.desc_entre }}
                                </p>
                                <span class="badge badge-entregable">{{ actividad.estado }}</span>
                                <small class="text-muted d-block mt-1">
                                    Vence: {{ actividad.fecha_fin|date:"d/m/Y" }}
                                </small>
                                
                            {% elif actividad.tipo_actividad == 'evento' %}
                                <h3 class="timeline-title-item">
                                    <i class="fas fa-calendar-alt"></i> {{ actividad.nom_eve }}
                                </h3>
                                <p class="timeline-description">
                                    {{ actividad.desc_eve }}
                                </p>
                                <span class="badge badge-evento">{{ actividad.modalidad_eve }}</span>-
                                <span class="badge badge-estado-{{ actividad.estado_eve|lower }}">{{ actividad.estado_eve }}</span>
                                <small class="text-muted d-block mt-1">
                                    {{ actividad.hora_inicio|time:"H:i" }} - {{ actividad.hora_fin|time:"H:i" }}
                                    {% if actividad.direccion_eve %}
                                        |  üìç {{ actividad.direccion_eve }}
                                    {% endif %}
                                </small>
                            {% endif %}
                        </div>
                        <div class="timeline-marker"></div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <p class="timeline-description">
                                <i class="fas fa-info-circle"></i> No hay actividades recientes en la √∫ltima semana
                            </p>
                        </div>
                        <div class="timeline-marker"></div>
                    </div>
                {% endif %}
            </div>
        </div>

    </div>

</div>

<script src="{% static 'js/mensaje.js' %}"></script>
<script src="{% static 'js/notificaciones.js' %}"></script>
{% endblock %}